Everything looks correct. The original specification had a bug in the weaklyConnected predicate, but it has been fixed in the provided solution.