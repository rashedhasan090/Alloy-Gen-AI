There seems to be no bug in this code.