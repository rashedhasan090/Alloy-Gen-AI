The original code seems to be correct. There is no bug found.