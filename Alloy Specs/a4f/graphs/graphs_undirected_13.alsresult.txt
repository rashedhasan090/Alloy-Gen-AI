The code seems to be correct and there doesn't appear to be any bug.