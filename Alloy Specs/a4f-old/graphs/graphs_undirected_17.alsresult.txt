The code seems to be correct and there is no bug.